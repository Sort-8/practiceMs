<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.arrangement.mapper.SysPracticeArrangementMapper">
    
    <resultMap type="SysPracticeArrangement" id="SysPracticeArrangementResult">
        <result property="arrangementId"    column="arrangement_id"    />
        <result property="stuId"    column="stu_id"    />
        <result property="infoId"    column="info_id"    />
        <result property="notes"    column="notes"    />
        <result property="stuOption"    column="stu_option"    />
        <result property="status"    column="status"    />
        <result property="delFlag"    column="del_flag"    />
        <association property="user"    column="user_id" javaType="SysUser" resultMap="SysUserResult" />
        <association property="info"    column="info_id" javaType="SysPracticeInfo" resultMap="SysPracticeInfoResult" />
    </resultMap>

    <resultMap type="SysUser" id="SysUserResult">
        <id     property="userId"       column="user_id"      />
        <result property="userName"     column="user_name"    />
        <result property="nickName"     column="nick_name"    />
    </resultMap>

    <resultMap type="SysPracticeInfo" id="SysPracticeInfoResult">
        <id     property="infoId"       column="info_id"      />
        <result property="postName"     column="post_name"    />
    </resultMap>

    <sql id="selectSysPracticeArrangementVo">
        select arrangement_id, stu_id, pa.info_id, notes, stu_option, pa.status, pa.del_flag , pi.post_name , u.user_id , u.user_name , u.nick_name
        from sys_practice_arrangement pa
            left join sys_practice_info pi on pa.info_id = pi.info_id
            left join sys_user u on pa.stu_id = u.user_id
    </sql>

    <select id="selectSysPracticeArrangementList" parameterType="SysPracticeArrangement" resultMap="SysPracticeArrangementResult">
        <include refid="selectSysPracticeArrangementVo"/>
        <where>  
            <if test="stuId != null "> and stu_id = #{stuId}</if>
            <if test="infoId != null "> and pa.info_id = #{infoId}</if>
            <if test="notes != null  and notes != ''"> and notes = #{notes}</if>
            <if test="arrangementId != null"> and arrangement_id = #{stuOption}</if>
            <if test="stuOption != null  and stuOption != ''"> and stu_option = #{stuOption}</if>
            <if test="status != null  and status != ''"> and pa.status = #{status}</if>
            <if test="delFlag != null  and delFlag != ''"> and pa.del_flag = #{delFlag}</if>
            <if test="stuId != null  and stuId != ''"> and u.user_id = #{stuId}</if>
            <if test="user != null  and user.userName != null"> and u.user_name = #{user.userName}</if>
            <if test="nickName != null  and nickName != ''"> and u.nick_name like concat('%',#{nickName},'%')</if>
            <if test="userName != null  and userName != ''"> and u.user_name like concat('%',#{userName},'%')</if>
            <if test="postName != null  and postName != ''"> and pi.post_name like concat('%',#{postName},'%')</if>
        </where>
    </select>
    
    <select id="selectSysPracticeArrangementById" parameterType="Long" resultMap="SysPracticeArrangementResult">
        <include refid="selectSysPracticeArrangementVo"/>
        where arrangement_id = #{arrangementId}
    </select>
        
    <insert id="insertSysPracticeArrangement" parameterType="SysPracticeArrangement" useGeneratedKeys="true" keyProperty="arrangementId">
        insert into sys_practice_arrangement
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="stuId != null">stu_id,</if>
            <if test="infoId != null">info_id,</if>
            <if test="notes != null">notes,</if>
            <if test="stuOption != null">stu_option,</if>
            <if test="status != null">status,</if>
            <if test="delFlag != null">del_flag,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="stuId != null">#{stuId},</if>
            <if test="infoId != null">#{infoId},</if>
            <if test="notes != null">#{notes},</if>
            <if test="stuOption != null">#{stuOption},</if>
            <if test="status != null">#{status},</if>
            <if test="delFlag != null">#{delFlag},</if>
         </trim>
    </insert>

    <update id="updateSysPracticeArrangement" parameterType="SysPracticeArrangement">
        update sys_practice_arrangement
        <trim prefix="SET" suffixOverrides=",">
            <if test="stuId != null">stu_id = #{stuId},</if>
            <if test="infoId != null">info_id = #{infoId},</if>
            <if test="notes != null">notes = #{notes},</if>
            <if test="stuOption != null">stu_option = #{stuOption},</if>
            <if test="status != null">status = #{status},</if>
            <if test="delFlag != null">del_flag = #{delFlag},</if>
        </trim>
        where arrangement_id = #{arrangementId}
    </update>

    <delete id="deleteSysPracticeArrangementById" parameterType="Long">
        delete from sys_practice_arrangement where arrangement_id = #{arrangementId}
    </delete>

    <delete id="deleteSysPracticeArrangementByIds" parameterType="String">
        delete from sys_practice_arrangement where arrangement_id in 
        <foreach item="arrangementId" collection="array" open="(" separator="," close=")">
            #{arrangementId}
        </foreach>
    </delete>
</mapper>